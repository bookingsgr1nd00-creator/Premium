---
permalink: /products.html
---
<!doctype html>
<html lang="en-CA">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Premium Supply — Catalogue</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="header">
    <div class="container header__inner">
      <a class="brand" href="index.html" aria-label="Home">
        <span class="brand__mark">PS</span>
        <span class="brand__text">
          <span class="brand__name">Premium Supply</span>
          <span class="brand__tag">Proudly Canadian • CAD</span>
        </span>
      </a>

      <nav class="header__links" aria-label="Primary">
        <a class="hlink" href="products.html" aria-current="page">Catalogue</a>
        <a class="hlink" href="account.html">Account</a>
        <a class="hlink" href="index.html">Home</a>
      </nav>

      <button class="btn btn--solid" id="openCart" type="button">
        Cart (<span id="cartCount">0</span>)
      </button>
    </div>

    <div class="container catbar" aria-label="Catalogue categories">
      <a class="chip" href="#cat-flowers">Flowers</a>
      <a class="chip" href="#cat-oil">Oil</a>
      <a class="chip" href="#cat-vapes">Vapes</a>
      <a class="chip" href="#cat-extracts">Extracts</a>
      <a class="chip" href="#cat-mushroom">Mushroom</a>
      <a class="chip" href="#cat-accessories">Accessories</a>
    </div>
  </header>

  <main class="section">
    <div class="container">
      <div class="pagehead">
        <h1 class="title">Catalogue</h1>
        <p class="sub">
          Add items to your cart. Payment instructions appear only after you place an order.
          Minimum order: <strong>$75 CAD</strong>.
        </p>
      </div>

      {% assign categories = "Flowers|Oil|Vapes|Extracts|Mushroom|Accessories" | split: "|" %}
      {% for cat in categories %}
        {% assign cat_id = cat | downcase | replace: " ", "-" %}
        {% assign cat_products = site.products | where: "active", true | where: "category", cat %}

        <section class="catsec" id="cat-{{ cat_id }}">
          <div class="catsec__head">
            <h2 class="catsec__title">{{ cat }}</h2>
            <p class="catsec__note">Curated options • Fast ordering • CAD pricing</p>
          </div>

          {% if cat_products and cat_products.size > 0 %}
            <div class="grid">
              {% for p in cat_products %}
                <article class="card product"
                  data-sku="{{ p.sku | escape }}"
                  data-name="{{ p.name | escape }}"
                  data-price="{{ p.price | default: 0 }}"
                  data-category="{{ p.category | escape }}"
                >
                  <div class="card__img">
                    {% if p.image %}
                      <img src="{{ p.image | escape }}" alt="{{ p.name | escape }}">
                    {% else %}
                      <div class="ph" aria-hidden="true"></div>
                    {% endif %}
                  </div>

                  <div class="card__body">
                    <div class="meta">
                      <span class="badge">{% if p.badge %}{{ p.badge }}{% else %}Standard{% endif %}</span>
                      <span class="sku">SKU: {{ p.sku }}</span>
                    </div>

                    <h3 class="card__title">{{ p.name }}</h3>
                    <p class="card__desc">{% if p.description %}{{ p.description }}{% else %}Premium-grade product, packaged for consistency.{% endif %}</p>

                    <div class="foot">
                      <div class="price">
                        <strong>${{ p.price }} CAD</strong>
                        {% if p.price_note %}<span class="muted small">{{ p.price_note }}</span>{% endif %}
                      </div>
                      <button class="btn btn--outline addBtn" type="button">Add</button>
                    </div>
                  </div>
                </article>
              {% endfor %}
            </div>
          {% else %}
            <div class="empty">
              <strong>No products yet in {{ cat }}.</strong>
              <div class="muted">Your employee can add items in /admin → Products.</div>
            </div>
          {% endif %}
        </section>
      {% endfor %}
    </div>
  </main>

  <!-- Cart Drawer -->
  <div class="backdrop" id="backdrop" hidden></div>

  <aside class="drawer" id="drawer" aria-hidden="true">
    <div class="drawer__head">
      <strong>Your Cart</strong>
      <button class="btn btn--outline" id="closeCart" type="button">Close</button>
    </div>

    <div class="drawer__body" id="cartItems"></div>

    <div class="drawer__foot">
      <div class="row">
        <span>Total</span>
        <strong id="cartTotal">$0.00 CAD</strong>
      </div>

      <div class="minrule" id="minRule"></div>

      <button class="btn btn--solid btn--full" id="checkoutBtn" type="button">
        Checkout
      </button>

      <p class="muted small">
        Payment details appear after you place an order.
      </p>
    </div>
  </aside>

  <!-- Checkout Modal -->
  <div class="modal" id="modal" hidden>
    <div class="panel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="panel__head">
        <strong id="modalTitle">Checkout</strong>
        <button class="btn btn--outline" id="closeModal" type="button">Close</button>
      </div>

      <div class="panel__body">
        <!-- STEP 1: Review + Place Order (NO payment instructions here) -->
        <section id="step1">
          <p class="muted small">Review your order, then place it to generate your confirmation number.</p>

          <div class="formgrid">
            <label class="field">
              <span>Full name</span>
              <input id="custName" type="text" placeholder="Your name">
            </label>
            <label class="field">
              <span>Phone</span>
              <input id="custPhone" type="tel" placeholder="(___) ___-____">
            </label>
            <label class="field">
              <span>City / Province</span>
              <input id="custCity" type="text" placeholder="Toronto, ON">
            </label>
            <label class="field">
              <span>Address (optional)</span>
              <input id="custAddr" type="text" placeholder="Street, unit, postal code">
            </label>
          </div>

          <div class="divider"></div>

          <div class="row">
            <span>Order total</span>
            <strong id="checkoutTotal">$0.00 CAD</strong>
          </div>

          <button class="btn btn--solid btn--full" id="placeOrderBtn" type="button">
            Place Order
          </button>

          <p class="muted small">
            Minimum order is $75 CAD. Payment instructions appear after placing the order.
          </p>
        </section>

        <!-- STEP 2: Payment Instructions (shown only AFTER Place Order) -->
        <section id="step2" hidden>
          <p class="muted small">Order confirmation number</p>
          <div class="copyrow">
            <strong id="orderId"></strong>
            <button class="btn btn--outline" id="copyOrderId" type="button">Copy</button>
          </div>

          <div class="divider"></div>

          <h3 class="h3">Interac e‑Transfer instructions</h3>
          <ol class="olist">
            <li>Send an Interac e‑Transfer to: <strong id="payEmail">payments@premiumsupply.ca</strong></li>
            <li>Include your order number in the transfer message/notes.</li>
            <li>Send your order email so we can confirm and fulfill.</li>
          </ol>

          <div class="danger">
            Account will be closed after 24h without payment.
            <div class="muted small" id="expiryLine"></div>
          </div>

          <div class="divider"></div>

          <a class="btn btn--solid btn--full" id="emailOrderBtn" href="#">
            Email order request
          </a>

          <details class="summary">
            <summary>View / copy order summary</summary>
            <pre id="orderSummary"></pre>
          </details>
        </section>
      </div>
    </div>
  </div>

  <!-- Inline JS only (no separate JS file) -->
  <script>
    // ========= EDIT THESE 2 EMAILS =========
    const ORDER_EMAIL = "orders@premiumsupply.ca";
    const PAYMENT_EMAIL = "payments@premiumsupply.ca";
    // ======================================

    const MIN_ORDER_CAD = 75;
    const POINTS_PER_DOLLAR = 1; // 1 point per $1 CAD spent

    const $ = (s) => document.querySelector(s);
    const fmt = (n) => new Intl.NumberFormat(undefined, { style: "currency", currency: "CAD" }).format(Number(n || 0));

    const cartKey = "ps_cart_v2";
    const loyaltyKey = "ps_loyalty_v1";

    let cart = JSON.parse(localStorage.getItem(cartKey) || "{}");

    const drawer = $("#drawer");
    const backdrop = $("#backdrop");
    const modal = $("#modal");

    const cartCountEl = $("#cartCount");
    const cartItemsEl = $("#cartItems");
    const cartTotalEl = $("#cartTotal");
    const checkoutTotalEl = $("#checkoutTotal");
    const minRuleEl = $("#minRule");

    function saveCart() { localStorage.setItem(cartKey, JSON.stringify(cart)); }
    function cartCount() { return Object.values(cart).reduce((a,b)=>a+b,0); }

    function cartTotal() {
      let total = 0;
      for (const sku in cart) {
        const qty = cart[sku];
        const el = document.querySelector('.product[data-sku="' + CSS.escape(sku) + '"]');
        const price = el ? Number(el.dataset.price || 0) : 0;
        total += price * qty;
      }
      return total;
    }

    function makeOrderId() {
      const d = new Date();
      const pad = (x) => String(x).padStart(2, "0");
      const r = Math.floor(Math.random() * 9000) + 1000;
      return "PS-" + d.getFullYear() + pad(d.getMonth()+1) + pad(d.getDate()) +
        "-" + pad(d.getHours()) + pad(d.getMinutes()) + pad(d.getSeconds()) + "-" + r;
    }

    function openDrawer() {
      drawer.classList.add("is-open");
      drawer.setAttribute("aria-hidden","false");
      backdrop.hidden = false;
    }
    function closeDrawer() {
      drawer.classList.remove("is-open");
      drawer.setAttribute("aria-hidden","true");
      backdrop.hidden = true;
    }
    function openModal() { modal.hidden = false; }
    function closeModal() { modal.hidden = true; }

    function renderCart() {
      cartCountEl.textContent = cartCount();

      const total = cartTotal();
      cartTotalEl.textContent = fmt(total) + " CAD";
      checkoutTotalEl.textContent = fmt(total) + " CAD";

      if (total < MIN_ORDER_CAD) {
        const diff = MIN_ORDER_CAD - total;
        minRuleEl.innerHTML = '<strong>Minimum order:</strong> $' + MIN_ORDER_CAD + ' CAD. Add ' + fmt(diff) + ' more.';
        $("#checkoutBtn").disabled = true;
        $("#checkoutBtn").classList.add("is-disabled");
      } else {
        minRuleEl.textContent = "Minimum order met.";
        $("#checkoutBtn").disabled = false;
        $("#checkoutBtn").classList.remove("is-disabled");
      }

      const skus = Object.keys(cart);
      if (!skus.length) {
        cartItemsEl.innerHTML = '<p class="muted">Your cart is empty.</p>';
        return;
      }

      cartItemsEl.innerHTML = skus.map((sku) => {
        const qty = cart[sku];
        const el = document.querySelector('.product[data-sku="' + CSS.escape(sku) + '"]');
        const name = el ? el.dataset.name : sku;
        const price = el ? Number(el.dataset.price || 0) : 0;

        return `
          <div class="line">
            <div>
              <strong>${name}</strong>
              <div class="muted small">SKU: ${sku} • ${fmt(price)} CAD</div>
            </div>
            <div class="qty">
              <button class="qbtn" data-dec="${sku}" type="button">−</button>
              <strong>${qty}</strong>
              <button class="qbtn" data-inc="${sku}" type="button">+</button>
            </div>
          </div>
        `;
      }).join("");

      cartItemsEl.querySelectorAll("[data-inc]").forEach((b) => {
        b.addEventListener("click", () => {
          const sku = b.getAttribute("data-inc");
          cart[sku] = (cart[sku] || 0) + 1;
          saveCart();
          renderCart();
        });
      });

      cartItemsEl.querySelectorAll("[data-dec]").forEach((b) => {
        b.addEventListener("click", () => {
          const sku = b.getAttribute("data-dec");
          cart[sku] = (cart[sku] || 0) - 1;
          if (cart[sku] <= 0) delete cart[sku];
          saveCart();
          renderCart();
        });
      });
    }

    // Add buttons
    document.querySelectorAll(".addBtn").forEach((btn) => {
      btn.addEventListener("click", () => {
        const card = btn.closest(".product");
        const sku = card.dataset.sku;
        cart[sku] = (cart[sku] || 0) + 1;
        saveCart();
        renderCart();
        openDrawer();
      });
    });

    // Drawer controls
    $("#openCart").addEventListener("click", () => { renderCart(); openDrawer(); });
    $("#closeCart").addEventListener("click", closeDrawer);
    backdrop.addEventListener("click", () => { closeDrawer(); closeModal(); });

    // Checkout flow
    $("#checkoutBtn").addEventListener("click", () => {
      if (cartTotal() < MIN_ORDER_CAD) return;
      $("#step1").hidden = false;
      $("#step2").hidden = true;
      openModal();
    });

    $("#closeModal").addEventListener("click", closeModal);

    function buildOrderEmail(orderId, expiresAt) {
      const lines = [];
      lines.push("Premium Supply — Order Request");
      lines.push("Order #: " + orderId);
      lines.push("Expires: " + new Date(expiresAt).toLocaleString());
      lines.push("");
      lines.push("Customer:");
      lines.push("- Name: " + ($("#custName").value || ""));
      lines.push("- Phone: " + ($("#custPhone").value || ""));
      lines.push("- City/Province: " + ($("#custCity").value || ""));
      lines.push("- Address: " + ($("#custAddr").value || ""));
      lines.push("");
      lines.push("Items:");

      let total = 0;
      for (const sku in cart) {
        const qty = cart[sku];
        const el = document.querySelector('.product[data-sku="' + CSS.escape(sku) + '"]');
        const name = el ? el.dataset.name : sku;
        const price = el ? Number(el.dataset.price || 0) : 0;
        total += price * qty;
        lines.push("- " + name + " (SKU: " + sku + ") x" + qty + " — " + fmt(price) + " CAD each");
      }

      lines.push("");
      lines.push("Total: " + fmt(total) + " CAD");
      lines.push("");
      lines.push("Payment (shown after order is placed): Interac e-Transfer");
      lines.push("Include Order # in transfer notes: " + orderId);
      lines.push("");
      lines.push("Account will be closed after 24h without payment.");

      return { body: lines.join("\\n"), total };
    }

    function updateLoyalty(total) {
      const earned = Math.floor(total * POINTS_PER_DOLLAR);
      const data = JSON.parse(localStorage.getItem(loyaltyKey) || "{}");

      data.points = Number(data.points || 0) + earned;
      data.spend = Number(data.spend || 0) + total;
      data.orders = Number(data.orders || 0) + 1;
      data.updatedAt = Date.now();

      localStorage.setItem(loyaltyKey, JSON.stringify(data));
      return { earned, data };
    }

    $("#placeOrderBtn").addEventListener("click", async () => {
      const total = cartTotal();
      if (total < MIN_ORDER_CAD) return;

      const orderId = makeOrderId();
      const expiresAt = Date.now() + 24 * 60 * 60 * 1000;

      const built = buildOrderEmail(orderId, expiresAt);
      updateLoyalty(built.total);

      // Show step2 now
      $("#orderId").textContent = orderId;
      $("#payEmail").textContent = PAYMENT_EMAIL;
      $("#expiryLine").textContent = "Pay before: " + new Date(expiresAt).toLocaleString();

      $("#orderSummary").textContent = built.body;

      const subject = "Order Confirmation " + orderId;
      const mailto = "mailto:" + encodeURIComponent(ORDER_EMAIL) +
        "?subject=" + encodeURIComponent(subject) +
        "&body=" + encodeURIComponent(built.body);

      $("#emailOrderBtn").setAttribute("href", mailto);

      $("#step1").hidden = true;
      $("#step2").hidden = false;
    });

    $("#copyOrderId").addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText($("#orderId").textContent);
        $("#copyOrderId").textContent = "Copied";
        setTimeout(() => $("#copyOrderId").textContent = "Copy", 1200);
      } catch (e) {
        $("#copyOrderId").textContent = "Copy failed";
        setTimeout(() => $("#copyOrderId").textContent = "Copy", 1200);
      }
    });

    // Init
    renderCart();
  </script>
</body>
</html>